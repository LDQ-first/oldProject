var canvas=function(){function t(t){[].slice.call(t).forEach(function(t,s){new i(t)})}function i(t){this.start(t);var i=this;this.clock(),window.addEventListener("resize",function(){i.init()}),this.control()}return i.prototype={start:function(t){this.canvas=t,this.judge(),this.init(),this.endTime=new Date,console.log(this.endTime),this.endTime.setHours(this.endTime.getHours()+99),console.log(this.endTime),this.ctl="countdown",this.getCurrentShowTimeSeconds(),this.curShowTimeSeconds=this.ret,console.log(this.curShowTimeSeconds),this.balls=[],this.colors=["#33B5E5","#0099CC","#AA66CC","#9933CC","#99CC00","#669900","#FFBB33","#FF8800","#FF4444","#CC0000"]},init:function(){console.log("init");var t=window.getComputedStyle(document.querySelector("#control")).height,i=window.getComputedStyle(document.querySelector("body")).paddingTop;this.canvas.width=document.body.clientWidth,this.canvas.height=document.body.clientHeight-t.replace(/px/,"")-i.replace(/px/,""),console.log(document.body.clientHeight),this.radius=Math.round(4*this.canvas.width/5/108)-1,this.margin_top=Math.round(this.canvas.height/5),this.margin_left=Math.round(this.canvas.width/10)},judge:function(){this.canvas.getContext("2d")?(this.context=this.canvas.getContext("2d"),console.log(this.context)):this.canvas.innerText="你的浏览器不支持canvas，请更换浏览器"},control:function(){var t=this,i=document.querySelectorAll("button");document.querySelector(".countdown").addEventListener("click",function(){this.classList.contains("active")||(console.log("countdown"),t.ctl="countdown",[].slice.call(i).forEach(function(t,i){t.classList.remove("active")}),this.classList.add("active"))}),document.querySelector(".clock").addEventListener("click",function(){this.classList.contains("active")||(console.log("clock"),t.ctl="clock",[].slice.call(i).forEach(function(t,i){t.classList.remove("active")}),this.classList.add("active"))})},drawline:function(){var t=this.context;t.beginPath(),t.moveTo(100,100),t.lineTo(700,700),t.lineTo(100,700),t.lineTo(102,102),t.closePath(),t.lineWidth=5,t.strokeStyle="rgba(250, 139, 67, 1)",t.stroke(),t.fillStyle="rgba(156, 141, 231, 1)",t.fill(),t.beginPath(),t.moveTo(200,100),t.lineTo(700,600),t.closePath(),t.strokeStyle="rgba(250, 139, 67, 1)",t.stroke()},tangramArr:function(t,i){this.tangram=[{p:[{x:0,y:0},{x:0,y:i},{x:t/2,y:i/2}],color:"#69BED0"},{p:[{x:0,y:0},{x:t,y:0},{x:t/2,y:i/2}],color:"#CAFF68"},{p:[{x:0,y:i},{x:t/2,y:i},{x:t/4,y:i/4*3}],color:"#F13C64"},{p:[{x:t/2,y:i},{x:t,y:i},{x:t,y:i/2}],color:"#ECEB10"},{p:[{x:t/2,y:i},{x:t/4*3,y:i/4*3},{x:t/2,y:i/2},{x:t/4,y:i/4*3}],color:"#A493BE"},{p:[{x:t/2,y:i/2},{x:t/4*3,y:i/4},{x:t/4*3,y:i/4*3}],color:"#F78ECE"},{p:[{x:t,y:0},{x:t/4*3,y:i/4},{x:t/4*3,y:i/4*3},{x:t,y:i/2}],color:"#F7CA28"}]},drawTangram:function(){var t=600,i=600,s=this;this.canvas.width=t,this.canvas.height=i,this.tangramArr(t,i),this.tangram.forEach(function(t,i){var e=t;s.setTangram(e)})},setTangram:function(t){var i=this.context;i.beginPath(),i.moveTo(t.p[0].x,t.p[0].y),t.p.forEach(function(t,s){var e=t;i.lineTo(e.x,e.y)}),i.closePath(),i.fillStyle=t.color,i.fill(),i.lineWidth=3,i.strokeStyle="rgba(250, 139, 67, 1)",i.stroke()},drawArc:function(){var t=this.context;t.lineWidth=5,t.strokeStyle="rgba(250, 139, 67, 1)";for(var i=0;i<10;i++)t.beginPath(),t.arc(50+100*i,60,40,0,2*Math.PI*(i+1)/10),t.closePath(),t.stroke();for(var i=0;i<10;i++)t.beginPath(),t.arc(50+100*i,180,40,0,2*Math.PI*(i+1)/10),t.stroke();for(var i=0;i<10;i++)t.beginPath(),t.arc(50+100*i,300,40,0,2*Math.PI*(i+1)/10,!0),t.closePath(),t.stroke();for(var i=0;i<10;i++)t.beginPath(),t.arc(50+100*i,420,40,0,2*Math.PI*(i+1)/10,!0),t.stroke();t.fillStyle="rgba(250, 139, 67, 1)";for(var i=0;i<10;i++)t.beginPath(),t.arc(50+100*i,540,40,0,2*Math.PI*(i+1)/10),t.closePath(),t.fill();for(var i=0;i<10;i++)t.beginPath(),t.arc(50+100*i,640,40,0,2*Math.PI*(i+1)/10),t.fill()},getCurrentShowTimeSeconds:function(){var t=new Date;"countdown"===this.ctl?(this.ret=this.endTime.getTime()-t.getTime(),this.ret=this.ret>=0?Math.round(this.ret/1e3):0):"clock"===this.ctl&&(this.ret=3600*t.getHours()+60*t.getMinutes()+t.getSeconds())},update:function(){this.getCurrentShowTimeSeconds(),this.nextShowTimeSeconds=this.ret,this.nextHours=parseInt(this.nextShowTimeSeconds/3600),this.nextMinutes=parseInt((this.nextShowTimeSeconds-3600*this.hours)/60),this.nextSeconds=parseInt(this.nextShowTimeSeconds%60),this.curHours=parseInt(this.curShowTimeSeconds/3600),this.curMinutes=parseInt((this.curShowTimeSeconds-3600*this.hours)/60),this.curSeconds=parseInt(this.curShowTimeSeconds%60),this.curShowTimeSeconds!=this.nextShowTimeSeconds&&(this.drawBalls(),this.curShowTimeSeconds=this.nextShowTimeSeconds),this.updateBalls()},drawBalls:function(){parseInt(this.curHours/10)!=parseInt(this.nextHours/10)&&this.addBalls(this.margin_left,this.margin_top,parseInt(this.hours/10)),parseInt(this.curHours%10)!=parseInt(this.nextHours%10)&&this.addBalls(this.margin_left+15*(this.radius+1),this.margin_top,parseInt(this.hours/10)),parseInt(this.curMinutes/10)!=parseInt(this.nextMinutes/10)&&this.addBalls(this.margin_left+39*(this.radius+1),this.margin_top,parseInt(this.minutes/10)),parseInt(this.curMinutes%10)!=parseInt(this.nextMinutes%10)&&this.addBalls(this.margin_left+54*(this.radius+1),this.margin_top,parseInt(this.minutes/10)),parseInt(this.curSeconds/10)!=parseInt(this.nextSeconds/10)&&this.addBalls(this.margin_left+78*(this.radius+1),this.margin_top,parseInt(this.seconds/10)),parseInt(this.curSeconds%10)!=parseInt(this.nextSeconds%10)&&this.addBalls(this.margin_left+93*(this.radius+1),this.margin_top,parseInt(this.seconds/10))},addBalls:function(t,i,s){var e=this;digit[s].forEach(function(s,n){s.forEach(function(s,a){var o={x:t+2*a*(e.radius+1)+(e.radius+1),y:i+2*n*(e.radius+1)+(e.radius+1),g:1.5*Math.random(),vx:4*Math.pow(-1,Math.ceil(1e3*Math.random())),vy:-5,color:e.colors[Math.floor(Math.random()*e.colors.length)]};e.balls.push(o)})})},updateBalls:function(){var t=this;this.balls.forEach(function(i,s){for(i.x+=i.vx,i.y+=i.vy,i.vy+=i.g,i.y>=t.canvas.height-t.radius&&(i.y=t.canvas.height-t.radius,i.vy=.75*-i.vy),(t.balls[s].x+t.radius<0||t.balls[s].x-t.radius>t.canvas.width||t.balls[s].y+t.radius<0)&&t.balls.splice(s,1);t.balls.length>300;)t.balls.pop()})},clock:function(){var t=this;setInterval(function(){document.hidden&&"visible"!==document.visibilityState?(document.hidden||"hidden"===document.visibilityState)&&(document.title="关闭了"):(document.title="打开了",t.drawClock(),t.update())},50)},drawClock:function(){var t=this.context,i=this;t.clearRect(0,0,this.canvas.width,this.canvas.height),this.hours=parseInt(this.curShowTimeSeconds/3600),this.minutes=parseInt((this.curShowTimeSeconds-3600*this.hours)/60),this.seconds=parseInt(this.curShowTimeSeconds%60),this.drawDight(this.margin_left,this.margin_top,parseInt(this.hours/10)),this.drawDight(this.margin_left+15*(this.radius+1),this.margin_top,parseInt(this.hours%10)),this.drawDight(this.margin_left+30*(this.radius+1),this.margin_top,10),this.drawDight(this.margin_left+39*(this.radius+1),this.margin_top,parseInt(this.minutes/10)),this.drawDight(this.margin_left+54*(this.radius+1),this.margin_top,parseInt(this.minutes%10)),this.drawDight(this.margin_left+69*(this.radius+1),this.margin_top,10),this.drawDight(this.margin_left+78*(this.radius+1),this.margin_top,parseInt(this.seconds/10)),this.drawDight(this.margin_left+93*(this.radius+1),this.margin_top,parseInt(this.seconds%10)),this.balls.forEach(function(s,e){t.fillStyle=s.color,t.beginPath(),t.arc(s.x,s.y,i.radius,0,2*Math.PI),t.closePath(),t.fill()})},drawDight:function(t,i,s){var e=this.context,n=this;e.fillStyle="rgba(0, 102, 153, 1)",digit[s].forEach(function(s,a){s.forEach(function(s,o){1===s&&(e.beginPath(),e.arc(t+2*o*(n.radius+1)+(n.radius+1),i+2*a*(n.radius+1)+(n.radius+1),n.radius,0,2*Math.PI),e.closePath(),e.fill())})})}},{draw:t}}();canvas.draw(document.querySelectorAll("#canvas"));